# â›½ GasMorph - æ„å›¾é©±åŠ¨çš„ Gas è¡¥è´´åè®®

GasMorph æ˜¯ä¸€ä¸ªåˆ›æ–°çš„æ„å›¾é©±åŠ¨ Gas è¡¥è´´åè®®ï¼Œæ—¨åœ¨å°† DApp çš„ Gas æ”¯å‡ºä»æˆæœ¬è½¬å˜ä¸ºå¯é‡åŒ–çš„å¢é•¿æŠ•èµ„ã€‚æœ¬é¡¹ç›®æ˜¯ä¸º Monad é»‘å®¢æ¾å¼€å‘çš„ MVP ç‰ˆæœ¬ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. åŸºäº NFT æŒæœ‰çš„åŠ¨æ€ Gas è¡¥è´´
- æŒæœ‰æŒ‡å®š NFT çš„ç”¨æˆ·è‡ªåŠ¨äº«å— Gas è¡¥è´´æœåŠ¡
- é€šè¿‡ ERC-4337 Paymaster å®ç°æ— ç¼çš„ç”¨æˆ·ä½“éªŒ
- æ”¯æŒæ™ºèƒ½åˆçº¦é’±åŒ…å’Œä¼ ç»Ÿ EOA é’±åŒ…

### 2. Gas Session é™æ—¶ä½“éªŒ
- ä¸ºç”¨æˆ·æä¾›é™æ—¶çš„å…è´¹ Gas ä½“éªŒ
- é™ä½æ–°ç”¨æˆ·çš„ä½¿ç”¨é—¨æ§›
- å¯é…ç½®çš„ Session æ—¶é•¿å’Œæƒé™

### 3. ERC-4337 è´¦æˆ·æŠ½è±¡
- åŸºäºæœ€æ–°çš„è´¦æˆ·æŠ½è±¡æ ‡å‡†
- æ”¯æŒ Bundler å’Œ Paymaster é›†æˆ
- æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ™ºèƒ½åˆçº¦
- **GasMorphPaymaster.sol**: æ ¸å¿ƒ Paymaster åˆçº¦ï¼Œå®ç° Gas è¡¥è´´é€»è¾‘
- **DemoNFT.sol**: æ¼”ç¤ºç”¨ NFT åˆçº¦ï¼Œç”¨äºæµ‹è¯• NFT æŒæœ‰éªŒè¯
- **æŠ€æœ¯æ ˆ**: Solidity ^0.8.20, OpenZeppelin Contracts

### å‰ç«¯åº”ç”¨
- **React + TypeScript**: ç°ä»£åŒ–çš„å‰ç«¯æ¡†æ¶
- **Ethers.js v6**: ä»¥å¤ªåŠäº¤äº’åº“
- **ERC-4337 é›†æˆ**: è´¦æˆ·æŠ½è±¡æ”¯æŒ

### ç½‘ç»œæ”¯æŒ
- **Monad æµ‹è¯•ç½‘**: ä¸»è¦æµ‹è¯•ç½‘ç»œ
- **ERC-4337 Bundler**: æ”¯æŒè´¦æˆ·æŠ½è±¡äº¤æ˜“

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 18.0.0
- npm æˆ– yarn
- MetaMask é’±åŒ…

### å®‰è£…ä¾èµ–

```bash
# å®‰è£…æ ¹ç›®å½•ä¾èµ–
npm install

# å®‰è£…å‰ç«¯ä¾èµ–
cd frontend
npm install
```

### éƒ¨ç½²åˆçº¦

1. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰ï¼š
```bash
export PRIVATE_KEY="your_private_key_here"
```

2. ç¼–è¯‘åˆçº¦ï¼š
```bash
npm run compile
```

3. éƒ¨ç½²åˆ° Monad æµ‹è¯•ç½‘ï¼š
```bash
npm run deploy
```

4. æ›´æ–°å‰ç«¯é…ç½®ï¼š
éƒ¨ç½²å®Œæˆåï¼Œå°†è¾“å‡ºçš„åˆçº¦åœ°å€æ›´æ–°åˆ° `frontend/src/utils/erc4337.ts` ä¸­çš„ `CONTRACT_ADDRESSES` é…ç½®ã€‚

### å¯åŠ¨å‰ç«¯åº”ç”¨

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
npm run frontend

# æˆ–åœ¨å‰ç«¯ç›®å½•
cd frontend
npm start
```

åº”ç”¨å°†åœ¨ `http://localhost:3000` å¯åŠ¨ã€‚

## ğŸ® æ¼”ç¤ºæµç¨‹

1. **è¿æ¥é’±åŒ…**
   - ç¡®ä¿é’±åŒ…å·²è¿æ¥åˆ° Monad æµ‹è¯•ç½‘
   - å¦‚æœæœªè¿æ¥ï¼Œåº”ç”¨ä¼šè‡ªåŠ¨æç¤ºæ·»åŠ ç½‘ç»œ

2. **ä½“éªŒ NFT æŒæœ‰è€…æ¨¡å¼**
   - ç‚¹å‡» "Mint NFT" æŒ‰é’®
   - å¦‚æœæŒæœ‰ NFTï¼Œäº¤æ˜“å°†è¢« GasMorph èµåŠ©

3. **å¼€å¯ Gas Session**
   - ç‚¹å‡» "å¼€å¯ 2 åˆ†é’Ÿå… Gas ä½“éªŒ" æŒ‰é’®
   - éœ€è¦åˆçº¦ owner æƒé™ï¼ˆåœ¨ MVP ä¸­ç”±éƒ¨ç½²è€…æ‰§è¡Œï¼‰

4. **ä½“éªŒ Session æ¨¡å¼**
   - åœ¨ Session æœŸé—´å†æ¬¡é“¸é€  NFT
   - äº¤æ˜“å°†è¢« GasMorph èµåŠ©

## ğŸ“ é¡¹ç›®ç»“æ„

```
gasmorph-hackathon/
â”œâ”€â”€ contracts/
â”‚   â”œâ”€â”€ GasMorphPaymaster.sol   # æ ¸å¿ƒ Paymaster åˆçº¦
â”‚   â””â”€â”€ DemoNFT.sol             # æ¼”ç¤ºç”¨ NFT åˆçº¦
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ deploy.ts               # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/         # React ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ConnectWallet.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ NFTMintCard.tsx
â”‚   â”‚   â”‚   â””â”€â”€ GasSessionManager.tsx
â”‚   â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â””â”€â”€ erc4337.ts      # ERC-4337 ç›¸å…³é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ App.tsx             # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ index.tsx
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ hardhat.config.ts
â””â”€â”€ package.json
```

## ğŸ”§ æ ¸å¿ƒåˆçº¦è¯´æ˜

### GasMorphPaymaster

æ ¸å¿ƒçš„ Paymaster åˆçº¦ï¼Œå®ç°äº†ä¸¤ç§ Gas è¡¥è´´æ¨¡å¼ï¼š

1. **NFT æ¨¡å¼** (`mode = 0x00`): éªŒè¯ç”¨æˆ·æ˜¯å¦æŒæœ‰æŒ‡å®šçš„ NFT
2. **Session æ¨¡å¼** (`mode = 0x01`): éªŒè¯ç”¨æˆ·çš„ Gas Session æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…

å…³é”®å‡½æ•°ï¼š
- `_validatePaymasterUserOp()`: æ ¸å¿ƒéªŒè¯é€»è¾‘
- `startGasSession()`: ä¸ºç”¨æˆ·å¼€å¯ Gas Session
- `getSessionStatus()`: æŸ¥è¯¢ç”¨æˆ·çš„ Session çŠ¶æ€

### DemoNFT

æ¼”ç¤ºç”¨çš„ NFT åˆçº¦ï¼Œç”¨äºæµ‹è¯• NFT æŒæœ‰éªŒè¯åŠŸèƒ½ï¼š

- `mint()`: ä»˜è´¹é“¸é€  NFT
- `mintForFree()`: å…è´¹é“¸é€ ï¼ˆä»… ownerï¼‰
- `balanceOf()`: æŸ¥è¯¢ç”¨æˆ· NFT ä½™é¢

## ğŸŒŸ åˆ›æ–°ç‰¹æ€§

1. **æ„å›¾é©±åŠ¨çš„ Gas è¡¥è´´**: æ ¹æ®ç”¨æˆ·çš„æ„å›¾å’Œè¡Œä¸ºåŠ¨æ€è°ƒæ•´ Gas è¡¥è´´ç­–ç•¥
2. **åŒé‡éªŒè¯æœºåˆ¶**: æ”¯æŒ NFT æŒæœ‰å’Œ Session ä¸¤ç§éªŒè¯æ–¹å¼
3. **æ— ç¼ç”¨æˆ·ä½“éªŒ**: åŸºäº ERC-4337 å®ç°çœŸæ­£çš„è´¦æˆ·æŠ½è±¡
4. **å¯æ‰©å±•æ¶æ„**: æ”¯æŒå¤šç§è¡¥è´´ç­–ç•¥å’ŒéªŒè¯æ–¹å¼

## ğŸ”® æœªæ¥è§„åˆ’

- [ ] æ”¯æŒæ›´å¤šéªŒè¯æ–¹å¼ï¼ˆä»£å¸æŒæœ‰ã€æ´»è·ƒåº¦ç­‰ï¼‰
- [ ] å®ç°åŠ¨æ€ Gas ä»·æ ¼é¢„æµ‹
- [ ] æ·»åŠ æ²»ç†æœºåˆ¶
- [ ] æ”¯æŒå¤šé“¾éƒ¨ç½²
- [ ] é›†æˆæ›´å¤š DApp å’Œåè®®

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

**GasMorph** - è®© Gas è´¹ç”¨æˆä¸ºå¢é•¿æŠ•èµ„ï¼Œè€Œä¸æ˜¯ä½¿ç”¨éšœç¢ã€‚ 