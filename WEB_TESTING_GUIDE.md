# GasMorph Web 端测试指南

## 🚀 准备工作

### 1. 确认服务运行状态
- ✅ Hardhat 区块链节点：http://localhost:8545
- ✅ 前端应用：http://localhost:3001
- ✅ 合约已部署并可用

### 2. 测试账户信息
```
Account #0 (Deployer): 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
Private Key: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80

Account #1 (User): 0x70997970C51812dc3A010C7d01b50e0d17dc79C8  
Private Key: 0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d
```

### 3. 合约地址
```
DemoNFT: 0x5FbDB2315678afecb367f032d93F642f64180aa3
GasMorphPaymaster: 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
```

## 🧪 测试步骤

### 步骤 1: 访问应用
1. 打开浏览器访问: **http://localhost:3001**
2. 确认页面标题显示："GasMorph - Gas 补贴协议"
3. 检查页面显示"Hardhat Local"网络标识

### 步骤 2: 连接钱包
1. 点击"连接钱包"按钮
2. 如果 MetaMask 提示添加网络，点击"添加网络"
3. 确认自动切换到 Hardhat Local 网络 (Chain ID: 31337)
4. 选择测试账户并连接
5. 确认显示钱包地址和"钱包连接成功"消息

### 步骤 3: 测试任务系统
1. 查看任务进度显示："已完成: 0/3"
2. 点击"📋 查看任务"按钮
3. 在弹出的任务列表中，点击每个任务的"完成"按钮
4. 确认每个任务完成后显示"✅ 已完成"
5. 完成至少2个任务后，确认"开启 2 分钟免 Gas 体验"按钮变为可用

### 步骤 4: 开启 Gas Session
1. 点击"开启 2 分钟免 Gas 体验"按钮
2. 确认 MetaMask 弹出交易确认
3. 确认交易并等待处理
4. 确认显示"Gas Session 已开启"消息
5. 确认显示倒计时器和 Session 状态为"活跃中"

### 步骤 5: 测试 NFT 铸造（免费模式）
1. 确认 Gas 状态显示"🟢 免费铸造 (Gas 已赞助)"
2. 点击"🎨 Mint NFT"按钮
3. 确认 MetaMask 弹出交易确认（Gas 费用应该很低或为0）
4. 确认交易并等待处理
5. 确认显示"🎉 NFT 铸造成功！Gas 已由 GasMorph 赞助！"
6. 确认铸造历史显示新记录，状态为"✅ 免费"
7. 重复几次铸造测试连续免费铸造

### 步骤 6: 等待 Session 过期
1. 等待 2 分钟倒计时结束
2. 确认 Session 状态变为"Session 已过期"
3. 确认 Gas 状态变为"🔴 需要支付 Gas 费用"

### 步骤 7: 测试 NFT 铸造（付费模式）
1. 点击"🎨 Mint NFT"按钮
2. 确认 MetaMask 显示需要支付 0.001 ETH
3. 确认交易并等待处理
4. 确认显示"🎉 NFT 铸造成功！您支付了 Gas 费用。"
5. 确认铸造历史显示新记录，状态为"💰 付费"

### 步骤 8: 验证区块链交易
1. 在 Hardhat 节点终端查看交易日志
2. 确认每次铸造都产生真实的区块链交易
3. 记录交易哈希并验证其真实性

## 🔍 预期结果

### 成功标准
- ✅ 钱包连接成功并自动切换网络
- ✅ 任务完成系统正常工作
- ✅ Gas Session 开启和倒计时功能正常
- ✅ 免费铸造模式正常工作（Session 活跃时）
- ✅ 付费铸造模式正常工作（Session 过期后）
- ✅ 所有交易都在区块链上产生真实记录
- ✅ UI 状态实时更新反映正确信息

### 错误处理
- ❌ 网络连接错误时显示适当错误消息
- ❌ 交易失败时显示详细错误信息
- ❌ 任务未完成时正确阻止 Session 开启

## 📊 性能指标

### 交易时间
- NFT 铸造：< 5秒
- Gas Session 开启：< 5秒
- 页面加载：< 3秒

### 用户体验
- 操作反馈即时
- 错误消息清晰
- 状态更新及时

## 🎯 Demo 重点

1. **任务驱动机制** - 展示用户需要完成任务才能获得优惠
2. **实时 Gas 状态** - 清晰显示当前是否享受免费 Gas
3. **真实区块链交互** - 每次操作都产生真实交易
4. **用户友好界面** - 现代化、响应式设计

## 🚨 故障排除

### 常见问题
1. **钱包连接失败**: 确认 MetaMask 已安装并解锁
2. **网络错误**: 确认 Hardhat 节点正在运行
3. **交易失败**: 检查账户余额是否足够
4. **页面加载慢**: 确认前端服务正常运行

### 重启服务
```bash
# 重启区块链节点
yarn chain

# 重新部署合约
yarn deploy

# 重启前端
yarn start
```

## 🎉 测试完成确认

完成所有测试步骤后，确认：
- [ ] 钱包连接功能正常
- [ ] 任务完成机制工作正常
- [ ] Gas Session 管理功能正常
- [ ] NFT 铸造（免费/付费）功能正常
- [ ] 区块链交易记录真实有效
- [ ] UI/UX 体验良好

**恭喜！GasMorph Demo 测试成功完成！** 🚀